<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings version="2.1"
	xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence/orm http://xmlns.jcp.org/xml/ns/persistence/orm_2_1.xsd" >

	<named-query name="contenido.byItem">
		<description>Return a list of contents by a defined item id</description>
		<query>
			<![CDATA[SELECT c FROM Contenido c 
				WHERE c.idItem = :idItem]]> 
        </query>
	</named-query>
	<named-query name="entidades.byTipo">
		<description>Return a list of entities by a type id</description>
		<query>
			<![CDATA[SELECT e FROM Entidad e 
				WHERE e.idTipo = :idTipo]]> 
        </query>
	</named-query>
	<named-query name="calificaciones.byItem">
		<description>Return a list of qualifications by a Item id</description>
		<query>
			<![CDATA[SELECT c FROM Calificacion c 
				WHERE c.idItem = :idItem
				ORDER by c.fecha desc]]> 
        </query>
	</named-query>
	<named-query name="calificaciones.byCatalogo">
		<description>Return a list of qualifications by a Catalog id</description>
		<query>
			<![CDATA[SELECT c FROM Calificacion c 
				WHERE c.idCatalogo = :idCatalogo]]> 
        </query>
	</named-query>
	<named-query name="catalogos.all">
		<description>Return a list of catalogs </description>
		<query>
			<![CDATA[SELECT c FROM Catalogo c ]]> 
        </query>
	</named-query>
	<named-query name="clasificaciones.all">
		<description>Return a list of clasifications </description>
		<query>
			<![CDATA[SELECT c FROM Clasificacion c]]> 
        </query>
	</named-query>
	<named-query name="preguntas.byItem">
		<description>Return a list of Questions by a Item id</description>
		<query>
			<![CDATA[SELECT q FROM Pregunta q 
				WHERE q.idItem = :idItem]]> 
        </query>
	</named-query>
	<named-query name="preguntas.byCatalogo">
		<description>Return a list of Questions by a Catalog id</description>
		<query>
			<![CDATA[SELECT q FROM Pregunta q 
				WHERE q.idCatalogo = :idCatalogo]]> 
        </query>
	</named-query>
	<named-query name="transacciones.byItembyUserByState">
		<description>Return a list of Transactions by a User id and State</description>
		<query>
			<![CDATA[SELECT t FROM Transaccion t 
				WHERE t.idItem    =  :idItem
				  AND t.idUsuario =  :idUsuario
				  AND t.estado    =  :estado]]> 
        </query>
	</named-query>
	
	<named-query name="transacciones.getAllTransaction">
		<description>Return all  Transactions</description>
		<query>
			<![CDATA[SELECT t FROM Transaccion t]]> 
        </query>
	</named-query>
	
	
	<named-query name="transacciones.enCarritoPorEntidad">
		<description>Return a list of transacctions that are on shopping car and where added from a entity</description>
		<query>
			<![CDATA[SELECT t FROM Transaccion t 
			WHERE t.estado IN ('Carrito','Procesada erronea') 
			AND t.idUsuario = :idEntidad]]> 
        </query>
	</named-query>
	
	<named-query name="transacciones.porIds">
		<description>Return a list of transacctions finded by ids</description>
		<query>
			<![CDATA[SELECT t FROM Transaccion t 
			WHERE t.id IN :idsTransacciones]]> 
        </query>
	</named-query>
	
	<named-query name="transacciones.porEntidad">
		<description>Return a list of transacctions by entity id</description>
		<query>
			<![CDATA[SELECT t FROM Transaccion t 
			WHERE t.idUsuario = :idEntidad]]> 
        </query>
	</named-query>	
	
	<named-query name="usuario.byEmail">
		<description>Return a user by his email</description>
		<query>
			<![CDATA[SELECT u FROM Usuario u
				JOIN FETCH u.entidad  
				WHERE u.email = :email 
				AND u.estado = 'ACTIVO']]> 
        </query>
	</named-query>
	
	<named-query name="usuario.bySocialId">
		<description>Return a user by social id</description>
		<query>
			<![CDATA[SELECT u FROM Usuario u
				JOIN FETCH u.entidad  
				JOIN u.redesSocialesUsuarios rs  
				WHERE rs.identificador = :socialId 
				AND u.estado = 'ACTIVO']]> 
        </query>
	</named-query>
	
	<named-query name="entidades.byEstado">
		<description>Return a list of entities by a state </description>
		<query>
			<![CDATA[SELECT e FROM Entidad e 
				WHERE e.estado = :estado]]> 
        </query>
	</named-query>

</entity-mappings>